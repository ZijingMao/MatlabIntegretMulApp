<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="73,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">input_data</span> ] = firfilter( <span class="var type1" id="S2T1U6">input_data</span>, <span class="var type1" id="S3T23U7">b</span>, <span class="var type2" id="S4T2V1U8">nFrames</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="73,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T2:U5"><span class="var type1" id="S5T2U11">groupDelay</span> = <span class="mxinfo " id="T2:U7">(<span class="mxinfo " id="T2:U8"><span class="mxinfo " id="T2:U9">length(<span class="var type1" id="S3T23U17">b</span>)</span> - <span class="mxinfo " id="T2:U11">1</span></span>) / <span class="mxinfo " id="T2:U12">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="73,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T8:U13"><span class="var type1" id="S7T8U22">dcArray</span> = <span class="mxinfo " id="T8:U15">[1 size(<span class="var type1" id="S2T1U29">input_data</span>,2) + 1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="73,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S9T2U34">iDc</span> = <span class="mxinfo " id="T2:U18">1:(length(<span class="var type1" id="S7T8U41">dcArray</span>) - 1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,8" id="srcline8"> 8</a></span><span class="line">        <span class="comment">% Pad beginning of data with DC constant and get initial conditions</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,9" id="srcline9"> 9</a></span><span class="line">        <span class="mxinfo " id="T2:U20"><span class="var type1" id="S10T2U45">ziDataDur</span> = <span class="mxinfo " id="T2:U22">min(<span class="var type1" id="S5T2U48">groupDelay</span>, <span class="mxinfo " id="T2:U24"><span class="var type1" id="S7T8U51">dcArray</span>(<span class="var type1" id="S9T2U53">iDc</span> + 1) - <span class="var type1" id="S7T8U56">dcArray</span>(<span class="var type1" id="S9T2U57">iDc</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="73,10" id="srcline10">10</a></span><span class="line">        [<span class="var type1" id="S12T23U61">temp</span>, <span class="var type1" id="S13T25U62">zi</span>] = filter(<span class="var type1" id="S3T23U65">b</span>, 1, double(<span class="mxinfo " id="T23:U32">[<span class="mxinfo " id="T23:U33"><span class="var type1" id="S2T1U72">input_data</span>(<span class="mxinfo " id="T6:U35">:</span>, <span class="mxinfo " id="T23:U36"><span class="mxinfo " id="T23:U37">ones(<span class="mxinfo " id="T6:U38">1</span>, <span class="var type1" id="S5T2U78">groupDelay</span>)</span> * <span class="mxinfo " id="T2:U40"><span class="var type1" id="S7T8U80">dcArray</span>(<span class="var type1" id="S9T2U81">iDc</span>)</span></span>)</span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,11" id="srcline11">11</a></span><span class="line">                                  <span class="mxinfo " id="T39:U43"><span class="var type1" id="S2T1U83">input_data</span>(<span class="mxinfo " id="T6:U45">:</span>, <span class="mxinfo " id="T41:U46"><span class="mxinfo " id="T2:U47"><span class="var type1" id="S7T8U87">dcArray</span>(<span class="var type1" id="S9T2U88">iDc</span>)</span>:(<span class="mxinfo " id="T2:U50"><span class="mxinfo " id="T2:U51"><span class="mxinfo " id="T2:U52"><span class="var type1" id="S7T8U93">dcArray</span>(<span class="var type1" id="S9T2U94">iDc</span>)</span> + <span class="var type1" id="S10T2U95">ziDataDur</span></span> - <span class="mxinfo " id="T2:U56">1</span></span>)</span>)</span>]</span>), [], 2);</span></span>
<span class="srcline"><span class="lineno"><a href="73,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,13" id="srcline13">13</a></span><span class="line">        <span class="mxinfo " id="T42:U57"><span class="var type1" id="S17T42U102">blockArray</span> = <span class="mxinfo " id="T42:U59">[<span class="mxinfo " id="T38:U60">(<span class="mxinfo " id="T2:U61"><span class="mxinfo " id="T2:U62"><span class="var type1" id="S7T8U110">dcArray</span>(<span class="var type1" id="S9T2U111">iDc</span>)</span> + <span class="var type1" id="S5T2U112">groupDelay</span></span>):<span class="var type1" id="S4T2U113">nFrames</span>:(<span class="var type1" id="S7T8U117">dcArray</span>(<span class="var type1" id="S9T2U119">iDc</span> + 1) - 1)</span> <span class="mxinfo " id="T2:U69"><span class="var type1" id="S7T8U123">dcArray</span>(<span class="mxinfo " id="T2:U71"><span class="var type1" id="S9T2U125">iDc</span> + 1</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="73,14" id="srcline14">14</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S18T2U129">iBlock</span> = <span class="mxinfo " id="T2:U74">1</span>:(<span class="mxinfo " id="T2:U75"><span class="mxinfo " id="T2:U76">length(<span class="var type1" id="S17T42U136">blockArray</span>)</span> - <span class="mxinfo " id="T2:U78">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="73,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,16" id="srcline16">16</a></span><span class="line">            <span class="comment">% Filter the data</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,17" id="srcline17">17</a></span><span class="line">            [<span class="mxinfo " id="T39:U79"><span class="var type1" id="S2T1U142">input_data</span>(<span class="mxinfo " id="T6:U81">:</span>, <span class="mxinfo " id="T41:U82">(<span class="mxinfo " id="T2:U83"><span class="mxinfo " id="T2:U84"><span class="var type1" id="S17T42U148">blockArray</span>(<span class="var type1" id="S18T2U149">iBlock</span>)</span> - <span class="var type1" id="S5T2U150">groupDelay</span></span>):(<span class="mxinfo " id="T2:U88"><span class="mxinfo " id="T2:U89"><span class="mxinfo " id="T2:U90"><span class="var type1" id="S17T42U155">blockArray</span>(<span class="mxinfo " id="T2:U92"><span class="var type1" id="S18T2U157">iBlock</span> + <span class="mxinfo " id="T2:U94">1</span></span>)</span> - <span class="var type1" id="S5T2U159">groupDelay</span></span> - <span class="mxinfo " id="T2:U96">1</span></span>)</span>)</span>, <span class="var type1" id="S13T25U161">zi</span>] = <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,18" id="srcline18">18</a></span><span class="line">                filter(<span class="var type1" id="S3T23U164">b</span>, 1, double(<span class="mxinfo " id="T39:U99"><span class="var type1" id="S2T1U169">input_data</span>(<span class="mxinfo " id="T6:U101">:</span>, <span class="mxinfo " id="T41:U102"><span class="mxinfo " id="T2:U103"><span class="var type1" id="S17T42U173">blockArray</span>(<span class="var type1" id="S18T2U174">iBlock</span>)</span>:(<span class="mxinfo " id="T2:U106"><span class="mxinfo " id="T2:U107"><span class="var type1" id="S17T42U178">blockArray</span>(<span class="mxinfo " id="T2:U109"><span class="var type1" id="S18T2U180">iBlock</span> + <span class="mxinfo " id="T2:U111">1</span></span>)</span> - <span class="mxinfo " id="T2:U112">1</span></span>)</span>)</span>), <span class="var type1" id="S13T25U183">zi</span>, 2);</span></span>
<span class="srcline"><span class="lineno"><a href="73,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,20" id="srcline20">20</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,22" id="srcline22">22</a></span><span class="line">        <span class="comment">% Pad end of data with DC constant</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,23" id="srcline23">23</a></span><span class="line">        <span class="mxinfo " id="T23:U114"><span class="var type1" id="S12T23U187">temp</span> = <span class="mxinfo " id="T23:U116">filter(<span class="var type1" id="S3T23U190">b</span>, 1, double(<span class="mxinfo " id="T23:U118"><span class="var type1" id="S2T1U195">input_data</span>(<span class="mxinfo " id="T6:U120">:</span>, <span class="mxinfo " id="T23:U121"><span class="mxinfo " id="T23:U122">ones(<span class="mxinfo " id="T6:U123">1</span>, <span class="var type1" id="S5T2U201">groupDelay</span>)</span> * (<span class="mxinfo " id="T2:U125"><span class="var type1" id="S7T8U205">dcArray</span>(<span class="var type1" id="S9T2U207">iDc</span> + 1) - 1</span>)</span>)</span>), <span class="var type1" id="S13T25U210">zi</span>, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="73,24" id="srcline24">24</a></span><span class="line">        <span class="mxinfo " id="T39:U129"><span class="mxinfo " id="T39:U130"><span class="var type1" id="S2T1U215">input_data</span>(<span class="mxinfo " id="T6:U132">:</span>, <span class="mxinfo " id="T41:U133">(<span class="mxinfo " id="T2:U134"><span class="mxinfo " id="T2:U135"><span class="var type1" id="S7T8U221">dcArray</span>(<span class="mxinfo " id="T6:U137"><span class="var type1" id="S9T2U223">iDc</span> + 1</span>)</span> - <span class="var type1" id="S10T2U225">ziDataDur</span></span>):(<span class="mxinfo " id="T2:U140"><span class="var type1" id="S7T8U229">dcArray</span>(<span class="var type1" id="S9T2U231">iDc</span> + 1) - 1</span>)</span>)</span> = <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,25" id="srcline25">25</a></span><span class="line">            <span class="mxinfo " id="T23:U143"><span class="var type1" id="S12T23U235">temp</span>(<span class="mxinfo " id="T6:U145">:</span>, <span class="mxinfo " id="T43:U146">(<span class="mxinfo " id="T2:U147"><span class="mxinfo " id="T2:U148"><span class="mxinfo " id="T2:U149">end</span> - <span class="var type1" id="S10T2U243">ziDataDur</span></span> + <span class="mxinfo " id="T2:U151">1</span></span>):<span class="mxinfo " id="T2:U152">end</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="73,26" id="srcline26">26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,27" id="srcline27">27</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,28" id="srcline28">28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="73,29" id="srcline29">29</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="73,30" id="srcline30">30</a></span><span class="line"></span></span>
</pre>
